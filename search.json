[{"title":"Hello World","url":"/2025/12/06/4a17b156/","content":"Welcome to Hexo! This is your very\r\nfirst post. Check documentation for\r\nmore info. If you get any problems when using Hexo, you can find the\r\nanswer in troubleshooting or\r\nyou can ask me on GitHub.\r\nQuick Start\r\nCreate a new post\r\nhexo new \"My New Post\"\r\nMore info: Writing\r\nRun server\r\nhexo server\r\nMore info: Server\r\nGenerate static files\r\nhexo generate\r\nMore info: Generating\r\nDeploy to remote sites\r\nhexo deploy\r\nMore info: Deployment\r\nTest\r\n\r\n\r\nf(x)â€„=â€„âˆ«âˆ’âˆâˆfÌ‚(x)Î¾â€†e2Ï€iÎ¾xâ€†dÎ¾\r\nsequenceDiagram\r\n    participant Alice\r\n    participant John\r\n    Alice-&gt;&gt;John: Hello John, how are you?\r\n    John-&gt;&gt;Alice: Fine, thanks, and you?\r\n    Alice-&gt;&gt;John: I'm fine, too.\r\n"},{"title":"[æ°´]èµ·äº2026-01-31 23:03çš„ä¸€ä»¶äº‹","url":"/2026/02/11/7875c8a8/","content":"èµ·äº\r\näº‹æƒ…èµ·äºè¿™æ ·æˆ‘ä»¬ç¾¤ä¸­ä¸€å¥è¯ï¼š ä¸ºäº†ä¸å€ŸåŠ©DDNSå°±æåˆ°ç”µè„‘çš„IPï¼Œæˆ‘æ‰“ç®—æä¸ªè‡ªåŠ¨çš„Pythonè„šæœ¬è·å–IPå¹¶é‚®ä»¶å‘é€\r\nè¿™æ ·å­æ˜¥èŠ‚å°±å¯ä»¥è¿œç¨‹æ“æ§\r\néœ‚é‡Œæ¢¦å‘“\r\nï¼ˆä»–ï¼‰æ‰“ç®—å¦‚ä¸‹\r\n\r\nè‡ªå¯åŠ¨\r\næ£€æµ‹ç½‘ç»œé€šæ–­\r\nipconfigè·å–ip\r\nå‘é‚®ä»¶ç»™è‡ªå·±\r\n\r\nè™½ç„¶è¿˜æ²¡æœ‰å¼€å§‹æ€ä¹ˆå­¦ä¹ ç¼–ç¨‹ï¼Œæˆ‘æ‰“ç®—æ‹¿æ¥ç»ƒç»ƒæ‰‹ï¼Œåªä¸è¿‡æ˜¯ç”¨C#å†™\r\næ­£æ–‡\r\næ„æ€\r\nåŸºæœ¬å®ç°\r\n\r\nè‡ªå¯åŠ¨ï¼šè®¡åˆ’ä»»åŠ¡å³å¯\r\næ£€æµ‹ç½‘ç»œé€šæ–­ï¼šç”¨APIå®ç°ï¼Œä¸é‡‡ç”¨å½“æ—¶ä¸€å¼€å§‹çš„pingçš„æƒ³æ³•\r\nè·å–IPï¼šAPI\r\nå‘é‚®ä»¶ï¼šSMTP MS Graph API\r\n\r\næ²¡æœ‰ä»€ä¹ˆå¤æ‚çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªé¡ºåºè¿‡ç¨‹\r\n\r\nå‡çº§\r\nè‡ªå¯åŠ¨åå¾ªç¯æ‰§è¡Œè¿‡ç¨‹ï¼Œä¸å†é€šè¿‡è®¡åˆ’ä»»åŠ¡å¤šæ¬¡è°ƒç”¨\r\nå¦‚æœç½‘ç»œä¸å¯ç”¨åˆ™5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ï¼Œç›´åˆ°æˆåŠŸï¼ˆæˆ–è€…ä½¿ç”¨åº“ä¸­ç›¸å…³æ–¹æ³•ï¼Ÿå¦‚æœå­˜åœ¨ï¼‰ã€‚\r\næŸ¥èµ„æ–™\r\næœ‰å…³åŸºæœ¬å®ç°\r\nç½‘ç»œéƒ¨åˆ†\r\nå¾ˆå®¹æ˜“æœç´¢åˆ°è¿™ä¸ªæ–‡æ¡£ï¼š ç½‘ç»œå¯ç”¨æ€§\r\n- .NET | Microsoft Learn\r\né‡Œé¢æåˆ°äº† System.Net.NetworkInformation å‘½åç©ºé—´ï¼Œæ¥ç€å¾€ä¸‹çœ‹æ–‡æ¡£\r\næ‰¾åˆ°NetworkInterfaceä¸­NetworkInterface.GetIsNetworkAvailable\r\næ–¹æ³•å¯ä»¥è·å–ç½‘ç»œå¯ç”¨æ€§\r\nå…¶ä¸­è¿˜æœ‰GetAllNetworkInterfaces()æ–¹æ³•ï¼Œè¿”å›NetworkInterface[]å¯¹è±¡æ•°ç»„\r\næ ¹æ®æŸ¥è¯¢é€”ä¸­é‡åˆ°çš„æ–‡æ¡£ç¤ºä¾‹ï¼šNetworkInterface[] -&gt; NetworkInterface\r\n-&gt; IPInterfaceProperties\r\nè¦è·å–ç½‘ç»œé…ç½®ï¼Œåº”è¯¥æ˜¯å…ˆè·å–ç½‘ç»œæ¥å£å¯¹è±¡ï¼Œä½¿ç”¨GetIPProperties()æ–¹æ³•ï¼Œè¿”å›IPInterfacePropertieså¯¹è±¡\r\næŸ¥çœ‹IPInterfaceProperties\r\nç±»æ–‡æ¡£\r\nâ€œæä¾›æœ‰å…³æ”¯æŒ Internet åè®®ç‰ˆæœ¬ 4 (IPv4) æˆ– Internet åè®®ç‰ˆæœ¬ 6\r\n(IPv6) çš„ç½‘ç»œæ¥å£çš„ä¿¡æ¯ã€‚â€ å¾ˆæ¥è¿‘æˆ‘ä»¬æƒ³è¦çš„è·å–IPäº†\r\nç¤ºä¾‹åŸºæœ¬ä¸Šè¾¾æˆäº†æˆ‘ä»¬çš„ç›®çš„ï¼Œåªéœ€è¦ç¨åŠ æ”¹åŠ¨ï¼Œç»“åˆNetworkInterface.GetIPProperties\r\næ–¹æ³•ä¸‹çš„ç¤ºä¾‹\r\né‚®ä»¶éƒ¨åˆ†\r\næ‰¾åˆ°SmtpClient\r\nç±»å’ŒMailMessage\r\nç±»\r\nä¸è¿‡ï¼Œåœ¨SmtpClientç±»ä¸­ï¼Œæ–‡æ¡£æ˜ç¡®æåˆ°â€œä¸å»ºè®®ä½¿ç”¨SmtpClient\r\nç±»è¿›è¡Œæ–°çš„å¼€å‘ï¼Œå› ä¸º SmtpClient ä¸æ”¯æŒè®¸å¤šæ–°å¼åè®®ã€‚ è¯·æ”¹ç”¨ MailKit\r\næˆ–å…¶ä»–åº“ã€‚â€ï¼Œæˆ‘å…ˆä¸ç®¡ä»–ï¼Œä»ç„¶ä½¿ç”¨\r\nå‚è€ƒç¤ºä¾‹ä¿®æ”¹å³å¯\r\næˆ‘æ‰“ç®—ä½¿ç”¨Microsoftçš„é‚®ç®±å‘é€ï¼Œç»“æœçœ‹äº†å¦‚ä½•è®¾ç½®å¤šåŠŸèƒ½è®¾å¤‡æˆ–åº”ç”¨ç¨‹åºä»¥ä½¿ç”¨\r\nMicrosoft 365 æˆ– Office 365\r\nå‘é€ç”µå­é‚®ä»¶æ‰å‘ç°ï¼Œè¿™æ ·å­å‘é‚®ä»¶éœ€è¦è´¦æˆ·å¯†ç æ‰è¡Œï¼Œæˆ‘ä¸å¤ªæƒ³è¿™æ ·ã€‚\r\nåªèƒ½æ”¹ç”¨MS Graph\r\nAPIäº†ï¼Œè®°å¾—é‡Œé¢æœ‰Email.Sendæƒé™ä»€ä¹ˆçš„ï¼Œåº”è¯¥å¯ä»¥ã€‚\r\nçœ‹æ–‡æ¡£æ ¹æ®æ–¹æ¡ˆé€‰æ‹©Microsoft\r\nGraph èº«ä»½éªŒè¯æä¾›ç¨‹åºçœ‹å¾—ä¸€å¤´é›¾æ°´ã€‚è¿˜æ˜¯é—®AIå§ã€‚\r\nğŸ’ æ€»ç»“ï¼šå¦‚ä½•é€‰ï¼Ÿ\r\n\r\nä½ çš„ç¨‹åºæ˜¯æ— åå°ã€ç”±ç”¨æˆ·è§¦å‘ã€ä»£è¡¨ä¸ªäººå‘ä¿¡å—ï¼Ÿ â†’\r\næˆæƒç æµï¼ˆæ–¹æ¡ˆäºŒï¼‰\r\nä½ çš„ç¨‹åºæ˜¯æ— äººå€¼å®ˆæœåŠ¡ã€å®šæ—¶ä»»åŠ¡ã€æˆ–éœ€è¦å‘ä¿¡ç»™å¤§é‡ç”¨æˆ·å—ï¼Ÿ\r\nâ†’ å®¢æˆ·ç«¯å‡­æ®æµ + è®¿é—®ç­–ç•¥é”å®šé‚®ç®±ï¼ˆæ–¹æ¡ˆä¸€ï¼‰\r\nä½ æ˜¯ SharePoint æ‰©å±•æˆ–ç‰¹å®šå¾®è½¯ä½ä»£ç å¹³å°ï¼Ÿ â†’\r\nå®è´¨ä¹Ÿæ˜¯æˆæƒç æµï¼Œä½†ç”±å¹³å°æ‰˜ç®¡ç™»å½•ã€‚\r\n\r\nå¦‚æœä½ çš„åœºæ™¯æ˜¯å…¸å‹çš„ ASP.NET Core\r\nåå°æœåŠ¡ï¼Œç›´æ¥å¥—ç”¨å®¢æˆ·ç«¯å‡­æ®æµ +\r\nè®¿é—®ç­–ç•¥æ˜¯æœ€å¹²å‡€ã€æœ€åˆè§„çš„åšæ³•ã€‚éœ€è¦æˆ‘æä¾›è¯¥æ¨¡å¼ä¸‹é…åˆåº”ç”¨è®¿é—®ç­–ç•¥é”å®šç‰¹å®šå‘ä¿¡é‚®ç®±çš„\r\nPowerShell è„šæœ¬ç¤ºä¾‹å—ï¼Ÿ\r\nDeepseek-V3.2\r\næˆ‘åªæˆªäº†ä¸€éƒ¨åˆ†ï¼Œçœ‹AIçš„è¯ï¼Œæˆ‘åº”è¯¥é€‰æ‹©æ–¹æ¡ˆä¸€ï¼Œå°±è¿™æ ·ã€‚\r\nåœ¨æ ¹æ®æ–¹æ¡ˆé€‰æ‹©Microsoft\r\nGraph\r\nèº«ä»½éªŒè¯æä¾›ç¨‹åºä¸­å¾ˆå®¹æ˜“æ‰¾åˆ°å®¢æˆ·ç«¯å‡­æ®æä¾›ç¨‹åºèŠ‚ã€‚\r\né‚®ä»¶å‘é€æœ‰userï¼šsendMail\r\nå‚è€ƒæ–‡æ¡£å³å¯ã€‚\r\nåç»­æ›´æ”¹\r\n\r\nNetworkChange\r\nç±»ï¼šå…è®¸åº”ç”¨ç¨‹åºåœ¨ç½‘ç»œæ¥å£ Internet åè®® (IP)\r\nåœ°å€ï¼ˆä¹Ÿç§°ä¸ºç½‘å¡æˆ–é€‚é…å™¨ï¼‰æ›´æ”¹æ—¶æ¥æ”¶é€šçŸ¥\r\nNetworkChange.NetworkAvailabilityChanged\r\näº‹ä»¶ï¼šåœ¨ç½‘ç»œçš„å¯ç”¨æ€§æ›´æ”¹æ—¶å‘ç”Ÿã€‚\r\n\r\næ„æƒ³\r\nåŸºæœ¬å®ç°æ„æƒ³\r\ngraph TD\r\n    A[ä»è®¡åˆ’ä»»åŠ¡å¯åŠ¨] --&gt; B1{åˆ¤æ–­ç½‘ç»œè¿é€šæ€§}\r\n    subgraph ç½‘ç»œ\r\n        B1 --&gt;|æœªè¿æ¥åˆ°äº’è”ç½‘| C1[ç­‰å¾…è®¡åˆ’ä»»åŠ¡å†æ¬¡è°ƒç”¨ï¼ˆé€€å‡º,1ï¼‰]\r\n        B1 --&gt;|è¿æ¥åˆ°äº’è”ç½‘| D1[è·å–ç½‘ç»œæ¥å£]\r\n        D1 --&gt;|éå†æ¥å£| E1[è·å–ç½‘ç»œæ¥å£å±æ€§]\r\n        E1 --&gt; F1[è·å–åœ°å€]\r\n    end\r\n\r\n    F1 --&gt; C[ç»„ç»‡é‚®ä»¶å†…å®¹]\r\n    C --&gt; C2\r\n\r\n    subgraph é‚®ä»¶\r\n        C2[å¡«å…¥å†…å®¹]\r\n        B2[åˆå§‹åŒ–graphClient] --&gt; C2[\"åˆå§‹åŒ–ä¿¡æ¯é‚®ä»¶(æ”¶ä»¶äººç­‰)\"]\r\n        C2 --&gt; D2[\"å‘é€(éšåé€€å‡º,0)\"]\r\n    end\r\nå†™ä»£ç &amp;é…ç½®\r\nç¨‹åº\r\næ·»åŠ Azure.Identity\r\nåŒ…å’ŒMicrosoft.Graph\r\nåŒ…\r\nè¿™é‡Œé‡‡ç”¨äº†å››ä¸ªç¤ºä¾‹ï¼Œåˆ†åˆ«å¤åˆ¶è‡ªGetIPProperties\r\næ–¹æ³•ã€IPInterfaceProperties\r\nç±»ã€å®¢æˆ·ç«¯å‡­æ®æä¾›ç¨‹åºå’Œä½¿ç”¨\r\nJSON æ ¼å¼å‘é€æ–°ç”µå­é‚®ä»¶\r\nRiderå¸®æˆ‘åœ¨ç»„ç»‡é‚®ä»¶å†…å®¹æ—¶æç¤ºäº†Environment.NewLineæŒºå¥½çš„ï¼ŒåŸæ¥è¿˜æœ‰è¿™ä¸ªä¸œè¥¿ï¼Œå­¦ä¹ äº†ã€‚\r\n\r\nä¸è¿‡æ®AI(DS)æ‰€è¯´ SMTP åè®®æ ‡å‡†ï¼ˆä»¥åŠ Microsoft Graph é‚®ä»¶\r\nAPIï¼‰é€šå¸¸è¦æ±‚æ¢è¡Œç¬¦ä¸º \\r\\n\r\n\r\næ ¹æ®AIè¯¢é—®ï¼Œæˆ‘é€‰æ‹©è¿™é‡Œä½¿ç”¨StringBuilderæ¥ç»„ç»‡å­—ç¬¦ä¸²å†…å®¹ï¼Œç„¶åAppendä¸­æ‰‹åŠ¨ä½¿ç”¨\r\n\\r\\n\r\næœ€åä»£ç å¦‚ä¸‹ï¼š\r\nusing System.Net.NetworkInformation;using System.Text;using Azure.Identity;using Microsoft.Graph;using Microsoft.Graph.Models;using Microsoft.Graph.Users.Item.SendMail;static string GetEmailContent(){    var sb = new StringBuilder();        NetworkInterface[] nics = NetworkInterface.GetAllNetworkInterfaces();    foreach (NetworkInterface adapter in nics)    {        if (!(adapter.Supports(NetworkInterfaceComponent.IPv4) ||  adapter.Supports(NetworkInterfaceComponent.IPv6)))        {            continue;        }                sb.Append(adapter.Description + \"\\r\\n\");        sb.Append(String.Empty.PadLeft(adapter.Description.Length,'=') + \"\\r\\n\");        IPInterfaceProperties adapterProperties = adapter.GetIPProperties();        MulticastIPAddressInformationCollection multiCast = adapterProperties.MulticastAddresses;        if (multiCast != null)        {            foreach (MulticastIPAddressInformation multi in multiCast)            {                 sb.Append($\"  Multicast Address ....................... : {multi.Address} \" + \"\\r\\n\");            }            sb.Append(\"\\r\\n\");        }        UnicastIPAddressInformationCollection uniCast = adapterProperties.UnicastAddresses;        if (uniCast != null)        {            foreach (UnicastIPAddressInformation uni in uniCast)             {                sb.Append($\"  Unicast Address ....................... : {uni.Address} \" + \"\\r\\n\");            }            sb.Append(\"\\r\\n\");        }    }        return sb.ToString();}async Task SendEmailByGraphApi(string content){    var scopes = new[] { \"https://graph.microsoft.com/.default\" };    var clientId = \"YOUR_CLIENT_ID\";    var tenantId = \"YOUR_TENANT_ID\";    var clientSecret = \"YOUR_CLIENT_SECRET\";    var options = new ClientSecretCredentialOptions    {        AuthorityHost = AzureAuthorityHosts.AzurePublicCloud,    };    var clientSecretCredential = new ClientSecretCredential(        tenantId, clientId, clientSecret, options);    var graphClient = new GraphServiceClient(clientSecretCredential, scopes);        var requestBody = new SendMailPostRequestBody    {        Message = new Message        {            Subject = \"IP\",            Body = new ItemBody            {                ContentType = BodyType.Text,                Content = content,            },            ToRecipients = new List&lt;Recipient&gt;            {                new Recipient                {                    EmailAddress = new EmailAddress                    {                        Address = \"frannis@contoso.com\",                    },                },            },        },        SaveToSentItems = false,    };    await graphClient.Users[\"sender@contoso.com\"].SendMail.PostAsync(requestBody);}if (!NetworkInterface.GetIsNetworkAvailable())    return 1;string content = GetEmailContent();await SendEmailByGraphApi(content);return 0;\r\nGraphåº”ç”¨ç¨‹åº\r\nç™»å½•Azure\r\nPortalï¼Œæ‰¾åˆ°åº”ç”¨æ³¨å†Œï¼Œæ³¨å†ŒEmailSenderåº”ç”¨ç¨‹åº\r\né…ç½®ä¸­æ‰¾åˆ°API æƒé™ã€‚ æ·»åŠ æƒé™-&gt;Microsoft\r\nGraph-&gt;åº”ç”¨ç¨‹åºæƒé™-&gt;Mail.Send-&gt;æ·»åŠ æƒé™\r\næˆ‘è‡ªå·±ç”¨çš„ï¼Œè¿™é‡Œå°±ç›´æ¥ä»£è¡¨æˆäºˆç®¡ç†å‘˜åŒæ„\r\nç„¶ååœ¨åº”ç”¨ç¨‹åºæ¦‚è¿°ä¸­ï¼Œå¤åˆ¶clientIdå’ŒtenantId(åº”ç”¨ç¨‹åº(å®¢æˆ·ç«¯)\r\nID å’Œ ç›®å½•(ç§Ÿæˆ·)\r\nID)ï¼Œå†™åˆ°YOUR_CLIENT_IDå’ŒYOUR_TENANT_ID\r\nç„¶åè½¬åˆ°è¯ä¹¦å’Œå¯†ç ï¼Œé€‰æ‹©æ–°å®¢æˆ·ç«¯å¯†ç ï¼Œæ·»åŠ ä¸€ä¸ªï¼Œç„¶åå¤åˆ¶å€¼ï¼Œå†™åˆ°YOUR_CLIENT_SECRET\r\n\n  \n    \n      ä¿¡æ¯\r\n\n    \n    \n      è®°å¾—å¦¥å–„ä¿ç®¡ï¼Œå› ä¸ºå€¼å†…å®¹ä»…åœ¨åˆæ¬¡åˆ›å»ºæ—¶æ˜¾ç¤ºã€‚\r\n\n    \n  \r\nåŸºæœ¬åŠŸèƒ½å®Œæˆ\r\næœ‰å…³åç»­çš„æ”¹è¿›ï¼Œç­‰æˆ‘æƒ³å†™äº†å†å†™å§ï¼›æ„Ÿè°¢Riderçš„æ”¯æŒ\r\nå…¶ä»–\r\nä¸»è¦å‚è€ƒäº†å¾®è½¯çš„æ–‡æ¡£ï¼ˆä¸»è¦å°±æ˜¯é‚£äº›ç¤ºä¾‹ï¼‰ï¼Œå¹¶æœ‰çš„æ—¶å€™è¯¢é—®äº†AI(Deepseek)ã€‚\r\nä¸»è¦é—®äº†ï¼š\r\n\r\nç½‘ç»œè¿é€šæ€§åˆ¤æ–­\r\nMicrosoft365 ä½¿ç”¨ Graph API å‘é€é‚®ä»¶å¯ä»¥ä½¿ç”¨å“ªäº›èº«ä»½è®¤è¯æ–¹å¼\r\nä¸€äº›é”™è¯¯çš„ä¿®å¤\r\n\r\n","categories":["çŒæ°´"],"tags":["æ°´","C#","é‚®ä»¶","Microsoft Graph API","Microsoft 365"]}]